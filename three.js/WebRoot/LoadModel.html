<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>加载模型</title>
		<style>
			body {
				margin: 0;
			}
			
			canvas {
				width: 100%;
				height: 100%
			}
		</style>

	</head>

	<body>
		<script src="../build/three.js"></script>
		<script src="../examples/js/Detector.js"></script>
		<script src="../examples/js/libs/stats.min.js"></script>

		<script>
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);

			var renderer = new THREE.WebGLRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			document.body.appendChild(renderer.domElement);
			camera.position.z = 5;

			var geometry = new THREE.BoxGeometry(1, 1, 1);
			var crateTexture = new THREE.ImageUtils.loadTexture("textures/jc.jpg");

			var material = new THREE.MeshBasicMaterial({
				map: crateTexture,
				color: 0xffffff,
				wireframe: false
			});

//			var loader = new THREE.JSONLoader();
//			loader.load('../WebRoot/models/Santa.js', function(model, materials) {
//				//loader.load('../examples/models/animated/monster/monster.js', function(geometry, materials) {
//
//				//materials[0].shading = THREE.FlatShading;
//					
//
//				mesh = new THREE.Mesh(geometry, new THREE.MultiMaterial(materials));
//				mesh.position.x = 0;
//				mesh.position.y = 0;
//				mesh.position.z = 0;
//				mesh.scale.x = mesh.scale.y = mesh.scale.z = 0.001;
//				scene.add(mesh);
//				
//			});

//			var loader = new THREE.JSONLoader();
//			var mesh;
//			loader.load('../WebRoot/models/Santa.js', function(model, mat) {
//				mat[0] = new THREE.MeshLambertMaterial({
//					color: 0x9ABF15,
//					skinning: true
//				});
//				mesh = new THREE.SkinnedMesh(model, mat[0]);
//
//				//animation = new THREE.an(model, model.animations);
//				animation = new THREE.Animation(mesh, mesh.animations[0]);
//				mesh.position.set(0, 5, 0);
//				mesh.scale.x = 3;
//				mesh.scale.y = 3;
//				mesh.scale.z = 4;
//				mesh.rotation.y = Math.PI;
//				mesh.name = 'fish' + fish_count;
//				scene.add(mesh);
//				//THREE.AnimationHandler.update(delta);
//				animation.play();
//			});

				var loader = new THREE.JSONLoader();
				var callbackMale = function ( geometry, materials ) { createScene( geometry, materials, 90, FLOOR, 50, 105 ) };
				//var callbackFemale = function ( geometry, materials ) { createScene( geometry, materials, -80, FLOOR, 50, 0 ) };

				loader.load( "../WebRoot/models/Santa.js", callbackMale );
				//loader.load( "obj/female02/Female02_slim.js", callbackFemale );

			function createScene( geometry, materials, x, y, z, b ) {

				zmesh = new THREE.Mesh( geometry, materials );
				zmesh.position.set( x, y, z );
				zmesh.scale.set( 3, 3, 3 );
				scene.add( zmesh );

				createMaterialsPalette( materials, 100, b );

			}

			function createMaterialsPalette( materials, size, bottom ) {

				for ( var i = 0; i < materials.length; i ++ ) {

					// material

					mesh = new THREE.Mesh( new THREE.PlaneBufferGeometry( size, size ), materials[i] );
					mesh.position.x = i * (size + 5) - ( ( materials.length - 1 )* ( size + 5 )/2);
					mesh.position.y = FLOOR + size/2 + bottom;
					mesh.position.z = -100;
					scene.add( mesh );

					// number

					var x = document.createElement( "canvas" );
					var xc = x.getContext( "2d" );
					x.width = x.height = 128;
					xc.shadowColor = "#000";
					xc.shadowBlur = 7;
					xc.fillStyle = "orange";
					xc.font = "50pt arial bold";
					xc.fillText( i, 10, 64 );

					var xm = new THREE.MeshBasicMaterial( { map: new THREE.CanvasTexture( x ), transparent: true } );

					mesh = new THREE.Mesh( new THREE.PlaneBufferGeometry( size, size ), xm );
					mesh.position.x = i * ( size + 5 ) - ( ( materials.length - 1 )* ( size + 5 )/2);
					mesh.position.y = FLOOR + size/2 + bottom;
					mesh.position.z = -99;
					scene.add( mesh );

				}

			}
			

			var cube = new THREE.Mesh(geometry, material);
			scene.add(cube);
			var animate = function() {
				requestAnimationFrame(animate);

				cube.rotation.x += 0.01;
				cube.rotation.y += 0.01;
				
				renderer.render(scene, camera);
			};

			animate();

			var ambiColor = "#0c0c0c";
			var ambientLight = new THREE.AmbientLight(ambiColor); //设置颜色
			scene.add(ambientLight);

			renderer.render(scene, camera);
		</script>

	</body>

</html>